# maly (c) 2013
# Generated by Puppet script
# do not make any changes here - it will be overwritten by Puppet

*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:<<COMPANY>>-INPUT - [0:0]

-I INPUT -j <<COMPANY>>-INPUT

<% if allowed_ranges.length > 0 %><% allowed_ranges.each do |element| -%>
-A <<COMPANY>>-INPUT -s <%= element %> -j ACCEPT
<% end %><% end %>
-A <<COMPANY>>-INPUT -i lo -j ACCEPT
-A <<COMPANY>>-INPUT -i <%= private_interface %> -j ACCEPT
-A <<COMPANY>>-INPUT -p icmp --icmp-type any -j ACCEPT
-A <<COMPANY>>-INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
-A <<COMPANY>>-INPUT -i <%= public_interface %> -j REJECT --reject-with icmp-host-prohibited
COMMIT

*nat
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]

#allow traffic from the instance to LAN (for Puppet and product download)
-A POSTROUTING -s <%= fixed_network_range %> -o <%= private_interface %> -j MASQUERADE

COMMIT
#end of file
